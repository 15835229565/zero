(function(n){n.fn.verifyCode=function(t){if(arguments.length>0&&typeof arguments[0]=="string"){if(arguments[0]=="validate"){var r=!1,f=n(this[0]).data("options"),e=n(this[0]).attr("jkey"),o=arguments[1],i=f.validateUrl,u="key="+e+"&code="+o;return i+=i.indexOf("?")==-1?"?"+u:"&"+u,n.ajax({url:i,async:!1,type:"get",dataType:"json",success:function(n){r=n}}),r}return}return t=n.extend({url:"",validateUrl:"",length:4},t),new n._verifyCode(this,t)};n._verifyCode=function(t,i){var r=this;n.extend(this,{refresh:function(n){var r="width="+n.width()+"&height="+n.height()+"&key="+n.attr("jkey")+"&r="+Math.random(),t=i.url;t+=t.indexOf("?")==-1?"?"+r:"&"+r;n.attr("src",t)}});t.each(function(t,u){var f=n(u),e;u.tagName=="IMG"&&(e=Math.random(),f.data("options",i).attr("jkey",e).css("cursor","pointer").click(function(){r.refresh(f)}),r.refresh(f))})}})(jQuery);
